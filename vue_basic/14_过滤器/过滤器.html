<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title>过滤器</title>
    <script type="text/javascript" src="../js/vue.js"></script>
    <script type="text/javascript" src="../js/dayjs.min.js"></script>
</head>

<!-- 

        定义: 对要显示的数据进行特定格式化后再显示 (适用于一些简单逻辑的处理, 复杂逻辑还是使用计算属性或方法).
        语法:
            1. 注册过滤器: 全局 Vue.filter(filterName, callback) 或 局部 new Vue { filters: {} }
            2. 使用过滤器: {{ param | filterName }} 或 v-bind:xxx="yyy | filterName"
        备注:
            1. 过滤器也可以接收额外参数, 多个过滤器也可以串联
            2. 过滤器并没有改变原本的数据, 会产生新的对应的数据 

-->

<body>
    <div id="root">
        <h2>解析时间</h2>
        <!-- 计算属性实现 -->
        <h3>当前时间为: {{ fmtTime }}</h3>
        <!-- 方法实现 -->
        <h3>当前时间为: {{ getCurTime() }}</h3>
        <!-- 过滤器实现 1 -->
        <h3>当前时间为: {{ time | timeFormater}}</h3>
        <!-- 过滤器实现 2 带参数 -->
        <h3>当前时间为: {{ time | timeFormater('YYYY-MM-DD') | mySlice }}</h3>

        <!-- 过滤器用法2: 可以用在标签上 -->
        <h3 :x="msg | mySlice">过滤器用法二</h3>
        <!-- 不能用在v-model双向绑定上 -->
        <!-- <input type="text" v-model="msg | mySlice"> -->
    </div>

    <div id="root2">
        <!-- 验证filters过滤器的局部性 -->
        <h3>局部过滤器: {{ msg | mySlice2 }}</h3>
        <!-- 验证Vue.filter全局过滤器 -->
        <h3>全局过滤器: {{ msg | mySlice }}</h3>
    </div>
</body>

<script type="text/javascript">
    Vue.config.productionTip = false;
    Vue.filter('mySlice', function (value) {
        return value.slice(0, 4);
    });

    new Vue({
        el: '#root',
        data: {
            time: 1733819044600,
            msg: '过滤器用法二'
        },
        computed: {
            fmtTime() {
                return dayjs(this.time).format('YYYY年MM月DD日 HH:mm:ss');
            }
        },
        methods: {
            getCurTime() {
                return dayjs(this.time).format('YYYY年MM月DD日 HH:mm:ss');
            }
        },
        filters: {
            // 当没有给timeFormater传入第二个参数时, 使用其默认参数'YYYY年MM月DD日 HH:mm:ss'
            timeFormater(value, str = 'YYYY年MM月DD日 HH:mm:ss') {
                return dayjs(value).format(str);
            },

            mySlice2(value) {
                return value.slice(0, 4);
            }
        }
    })

    new Vue({
        el: '#root2',
        data: {
            msg: 'filters过滤器具有局部性, 只能在一个vm组件实例中起效'
        }
    })
</script>

</html>